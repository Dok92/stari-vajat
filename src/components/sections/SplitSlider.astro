---
import { t } from 'i18next';
import SectionsDescriptor from './SectionsDescriptor.astro';
import AnimateOnScroll from '../../animations/AnimateOnScroll.astro';
import Slide from '../sliders/Slide.astro';
import type { TextPart } from './Split2.astro';

// Hard-coded text structure
const aboutText: TextPart[] = [
  {
    content: [t('about.text.part1')],
  },
  { type: 'empty-line' },
  {
    content: [t('about.text.part2')],
  },
  { type: 'empty-line' },
  {
    content: [t('about.text.part3')],
  },
];

// Helper function to render text content
function renderContent(content: (string | { text: string; style?: 'bold' | 'italic' })[]) {
  return content
    .map((item, idx) => {
      if (typeof item === 'string') {
        return item;
      }
      if (item.style === 'bold') {
        return `<strong key=${idx}>${item.text}</strong>`;
      }
      if (item.style === 'italic') {
        return `<em key=${idx}>${item.text}</em>`;
      }
      return item.text;
    })
    .join('');
}
---

<section class='section split-slider text-left' id={t('id.section-3')}>
  <div class='content'>
    <div class='content-top'>
      <SectionsDescriptor headline={t('about.headline')} />
      <AnimateOnScroll animation='slide-from-left' duration={1} delay={0}>
        <h2 class='section-title'>{t('about.title')}</h2>
      </AnimateOnScroll>
    </div>
    <AnimateOnScroll animation='up-slide' duration={1} delay={0.4}>
      <div class='section-text'>
        {
          aboutText.map((part) => {
            if (part.type === 'empty-line') {
              return <div class='empty-line' />;
            }
            if (part.type === 'line-break') {
              return <br />;
            }
            return <p set:html={renderContent(part.content)} />;
          })
        }
      </div>
    </AnimateOnScroll>
  </div>
  <div class='slider-container'>
    <Slide />
  </div>
</section>

<style>
  .section.split-slider {
    display: grid;
    grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
    gap: var(--section-spacing-lg, 48px);
    align-items: start;
    overflow: hidden;
    padding: 0 var(--section-spacing-lg);
  }

  /* Text on the left - slider on right */
  .section.split-slider.text-left {
    grid-template-areas: 'content slider';
  }

  .section.split-slider.text-left .slider-container {
    grid-area: slider;
  }

  .section.split-slider.text-left .content {
    grid-area: content;
  }

  .slider-container {
    display: flex;
    flex-direction: column;
    width: 100%;
    min-width: 0;
  }

  .content {
    width: 100%;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: var(--section-spacing-sm);
  }

  .section-title {
    font-size: var(--fs-600);
    font-weight: 700;
    word-wrap: break-word;
    overflow-wrap: break-word;
  }

  .section-text {
    font-size: var(--fs-200);
    line-height: 1.6;
    word-wrap: break-word;
    overflow-wrap: break-word;
  }

  .section-text p {
    margin: 0;
    display: inline;
  }

  .section-text .empty-line {
    height: 1em;
    display: block;
  }

  .section-text strong {
    font-weight: 700;
  }

  .section-text em {
    font-style: italic;
  }

  @media (max-width: 1250px) {
    .section.split-slider {
      gap: var(--section-spacing-sm, 32px);
      padding: 0 var(--section-spacing-lg);
      margin-bottom: var(--section-spacing-lg);
    }
  }

  /* Responsive: stack on mobile */
  @media (max-width: 768px) {
    .section-title {
      margin-bottom: var(--space-600);
    }

    .section.split-slider {
      grid-template-columns: 1fr;
      gap: var(--section-spacing-md, 32px);
    }

    /* Content first, then slider on mobile */
    .section.split-slider.text-left {
      grid-template-areas:
        'content'
        'slider';
    }
  }
</style>
